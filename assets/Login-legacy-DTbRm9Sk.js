System.register(["./index-legacy-BrREQsT8.js","./_commonjsHelpers-legacy-Dm4tvPOc.js"],(function(e,t){"use strict";var o,n,r,i,s,a,l,u,c,d,f,p,g,m,h,v,y,w,b,x,B,_,C,I;return{setters:[e=>{o=e.d,n=e.a,r=e.I,i=e.b,s=e.c,a=e.l,l=e.i,u=e.e,c=e.s,d=e.D,f=e.f,p=e.u,g=e.P,m=e._,h=e.g,v=e.w,y=e.r,w=e.o,b=e.h,x=e.j,B=e.k,_=e.m,C=e.t},e=>{I=e.g}],execute:function(){var t=document.createElement("style");t.textContent=".backdrop[data-v-c2fbb6b0]{background:#001240;background:linear-gradient(326deg,#001240,#040f2e 43%,#031244 74%,#042561)}.custom-label[data-v-c2fbb6b0] .v-field-label.v-field-label--floating{opacity:1!important}.my-custom-alert .alert-message{color:#000!important;font-weight:300;font-style:italic}\n",document.head.appendChild(t);const T=o("rules",{state:()=>({rules:{required:e=>!!e||"Field is required"}})});var k,S,O={exports:{}},A={exports:{}};k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&S.rotl(e,8)|4278255360&S.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=S.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],o=0,n=0;o<e.length;o++,n+=8)t[n>>>5]|=e[o]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],o=0;o<32*e.length;o+=8)t.push(e[o>>>5]>>>24-o%32&255);return t},bytesToHex:function(e){for(var t=[],o=0;o<e.length;o++)t.push((e[o]>>>4).toString(16)),t.push((15&e[o]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],o=0;o<e.length;o+=2)t.push(parseInt(e.substr(o,2),16));return t},bytesToBase64:function(e){for(var t=[],o=0;o<e.length;o+=3)for(var n=e[o]<<16|e[o+1]<<8|e[o+2],r=0;r<4;r++)8*o+6*r<=8*e.length?t.push(k.charAt(n>>>6*(3-r)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],o=0,n=0;o<e.length;n=++o%4)0!=n&&t.push((k.indexOf(e.charAt(o-1))&Math.pow(2,-2*n+8)-1)<<2*n|k.indexOf(e.charAt(o))>>>6-2*n);return t}},A.exports=S;var P=A.exports,H={utf8:{stringToBytes:function(e){return H.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(H.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],o=0;o<e.length;o++)t.push(255&e.charCodeAt(o));return t},bytesToString:function(e){for(var t=[],o=0;o<e.length;o++)t.push(String.fromCharCode(e[o]));return t.join("")}}},q=H,D=function(e){return null!=e&&(j(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&j(e.slice(0,0))}(e)||!!e._isBuffer)};function j(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}!function(){var e=P,t=q.utf8,o=D,n=q.bin,r=function(i,s){i.constructor==String?i=s&&"binary"===s.encoding?n.stringToBytes(i):t.stringToBytes(i):o(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||i.constructor===Uint8Array||(i=i.toString());for(var a=e.bytesToWords(i),l=8*i.length,u=1732584193,c=-271733879,d=-1732584194,f=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[14+(l+64>>>9<<4)]=l;var g=r._ff,m=r._gg,h=r._hh,v=r._ii;for(p=0;p<a.length;p+=16){var y=u,w=c,b=d,x=f;u=g(u,c,d,f,a[p+0],7,-680876936),f=g(f,u,c,d,a[p+1],12,-389564586),d=g(d,f,u,c,a[p+2],17,606105819),c=g(c,d,f,u,a[p+3],22,-1044525330),u=g(u,c,d,f,a[p+4],7,-176418897),f=g(f,u,c,d,a[p+5],12,1200080426),d=g(d,f,u,c,a[p+6],17,-1473231341),c=g(c,d,f,u,a[p+7],22,-45705983),u=g(u,c,d,f,a[p+8],7,1770035416),f=g(f,u,c,d,a[p+9],12,-1958414417),d=g(d,f,u,c,a[p+10],17,-42063),c=g(c,d,f,u,a[p+11],22,-1990404162),u=g(u,c,d,f,a[p+12],7,1804603682),f=g(f,u,c,d,a[p+13],12,-40341101),d=g(d,f,u,c,a[p+14],17,-1502002290),u=m(u,c=g(c,d,f,u,a[p+15],22,1236535329),d,f,a[p+1],5,-165796510),f=m(f,u,c,d,a[p+6],9,-1069501632),d=m(d,f,u,c,a[p+11],14,643717713),c=m(c,d,f,u,a[p+0],20,-373897302),u=m(u,c,d,f,a[p+5],5,-701558691),f=m(f,u,c,d,a[p+10],9,38016083),d=m(d,f,u,c,a[p+15],14,-660478335),c=m(c,d,f,u,a[p+4],20,-405537848),u=m(u,c,d,f,a[p+9],5,568446438),f=m(f,u,c,d,a[p+14],9,-1019803690),d=m(d,f,u,c,a[p+3],14,-187363961),c=m(c,d,f,u,a[p+8],20,1163531501),u=m(u,c,d,f,a[p+13],5,-1444681467),f=m(f,u,c,d,a[p+2],9,-51403784),d=m(d,f,u,c,a[p+7],14,1735328473),u=h(u,c=m(c,d,f,u,a[p+12],20,-1926607734),d,f,a[p+5],4,-378558),f=h(f,u,c,d,a[p+8],11,-2022574463),d=h(d,f,u,c,a[p+11],16,1839030562),c=h(c,d,f,u,a[p+14],23,-35309556),u=h(u,c,d,f,a[p+1],4,-1530992060),f=h(f,u,c,d,a[p+4],11,1272893353),d=h(d,f,u,c,a[p+7],16,-155497632),c=h(c,d,f,u,a[p+10],23,-1094730640),u=h(u,c,d,f,a[p+13],4,681279174),f=h(f,u,c,d,a[p+0],11,-358537222),d=h(d,f,u,c,a[p+3],16,-722521979),c=h(c,d,f,u,a[p+6],23,76029189),u=h(u,c,d,f,a[p+9],4,-640364487),f=h(f,u,c,d,a[p+12],11,-421815835),d=h(d,f,u,c,a[p+15],16,530742520),u=v(u,c=h(c,d,f,u,a[p+2],23,-995338651),d,f,a[p+0],6,-198630844),f=v(f,u,c,d,a[p+7],10,1126891415),d=v(d,f,u,c,a[p+14],15,-1416354905),c=v(c,d,f,u,a[p+5],21,-57434055),u=v(u,c,d,f,a[p+12],6,1700485571),f=v(f,u,c,d,a[p+3],10,-1894986606),d=v(d,f,u,c,a[p+10],15,-1051523),c=v(c,d,f,u,a[p+1],21,-2054922799),u=v(u,c,d,f,a[p+8],6,1873313359),f=v(f,u,c,d,a[p+15],10,-30611744),d=v(d,f,u,c,a[p+6],15,-1560198380),c=v(c,d,f,u,a[p+13],21,1309151649),u=v(u,c,d,f,a[p+4],6,-145523070),f=v(f,u,c,d,a[p+11],10,-1120210379),d=v(d,f,u,c,a[p+2],15,718787259),c=v(c,d,f,u,a[p+9],21,-343485551),u=u+y>>>0,c=c+w>>>0,d=d+b>>>0,f=f+x>>>0}return e.endian([u,c,d,f])};r._ff=function(e,t,o,n,r,i,s){var a=e+(t&o|~t&n)+(r>>>0)+s;return(a<<i|a>>>32-i)+t},r._gg=function(e,t,o,n,r,i,s){var a=e+(t&n|o&~n)+(r>>>0)+s;return(a<<i|a>>>32-i)+t},r._hh=function(e,t,o,n,r,i,s){var a=e+(t^o^n)+(r>>>0)+s;return(a<<i|a>>>32-i)+t},r._ii=function(e,t,o,n,r,i,s){var a=e+(o^(t|~n))+(r>>>0)+s;return(a<<i|a>>>32-i)+t},r._blocksize=16,r._digestsize=16,O.exports=function(t,o){if(null==t)throw new Error("Illegal argument "+t);var i=e.wordsToBytes(r(t,o));return o&&o.asBytes?i:o&&o.asString?n.bytesToString(i):e.bytesToHex(i)}}();var V=O.exports;const U=I(V),z=n({components:{IonPage:s,IonFooter:i,IonTitle:r},data:()=>({show:!1,rules:T().rules.required,loading:!1,model:{username:null,password:null},version:"1.2.30",dataSync:c()}),methods:{async login(){const e=await this.$refs.form.validate(),t=await a.create({message:"Logging in, please wait..",translucent:!0,spinner:"lines"});if(e.valid){this.loading=!0;const e=async e=>{const o=await d.getInfo(),n=await d.getId(),r=U(e.password);e.platform=this.platform,e.model=null==(null==o?void 0:o.model)||null==(null==n?void 0:n.identifier)?null:`${null==o?void 0:o.model}=>${null==n?void 0:n.identifier}`,e.deviceID=null==(null==n?void 0:n.identifier)?null:null==n?void 0:n.identifier,await t.present();try{const{data:o}=await this.$api.login({method:"post",data:{...e,password:r}});if(3==(null==o?void 0:o.status))await t.dismiss(),u.warning("The system could not recognize your user credentials.",{autoClose:1500,position:"web"==this.platform?"top-right":"top-center",closeButton:!1,hideProgressBar:!0,transition:"slide",pauseOnHover:!1,toastId:"unique-toast-id",closeOnClick:!1});else if(2==(null==o?void 0:o.status))await t.dismiss(),u.warning("You cannot register any more devices. Maximum limit reached.",{autoClose:1500,position:"web"==this.platform?"top-right":"top-center",closeButton:!1,hideProgressBar:!0,transition:"slide",pauseOnHover:!1,toastId:"unique-toast-id",closeOnClick:!1});else if(Boolean(null==o?void 0:o.isNewDevice)){await t.dismiss();const e=await f.create({header:"System Notice",subHeader:"Device registration",cssClass:"my-custom-alert",message:"Device successfully registered to server. You will only be able to access your account from registered devices.",buttons:[{text:"Proceed",role:"confirm"}],backdropDismiss:!1});await e.present();const{role:n}=await e.onDidDismiss();if("confirm"==n){const e=p();await e.dbInit(),await g.set({key:"userinfo",value:JSON.stringify(o.userinfo)}),this.$router.replace({path:"/index/home"}),await this.dataSync.syncAll()}else this.loading=!1,await t.dismiss()}else{const e=p();await e.dbInit(),await g.set({key:"userinfo",value:JSON.stringify(o.userinfo)}),await t.dismiss(),this.$router.replace({path:"/index/home"}),await this.dataSync.syncAll()}}catch(i){await t.dismiss(),u.error("An error occurred while logging in.",{autoClose:1500,position:"web"==this.platform?"top-right":"top-center",closeButton:!1,hideProgressBar:!0,transition:"slide",pauseOnHover:!1,toastId:"unique-toast-id",closeOnClick:!1})}};"web"==this.platform?l.value?(this.loading=!1,await e(this.model)):u.warning("Cannot connect to server, Please check your internet connection.",{autoClose:1e3,closeButton:!1,hideProgressBar:!0,transition:"slide",pauseOnHover:!1,toastId:"unique-toast-id",position:"web"==this.platform?"top-right":"top-center",closeOnClick:!1}):l.value?(this.loading=!1,await e(this.model)):(u.warning("Cannot connect to server, Please check your internet connection.",{autoClose:1e3,closeButton:!1,hideProgressBar:!0,transition:"slide",pauseOnHover:!1,toastId:"unique-toast-id",position:"web"==this.platform?"top-right":"top-center",closeOnClick:!1}),this.loading=!1)}}}}),M={class:"vlabel text-overline font-weight-bold text-white"};e("default",m(z,[["render",function(e,t,o,n,r,i){const s=y("v-img"),a=y("v-card-title"),l=y("v-text-field"),u=y("v-card-text"),c=y("v-icon"),d=y("v-btn"),f=y("v-card-actions"),p=y("v-form"),g=y("v-card"),m=y("v-container"),I=y("ion-title"),T=y("ion-footer"),k=y("ion-page");return w(),h(k,{class:"backdrop"},{default:v((()=>[b(m,{class:"mx-auto"},{default:v((()=>[b(g,{tile:"",width:"web"!=e.platform||e.isMobile?"":"40%",class:"mx-auto my-auto overflow-y-hidden rounded bg-transparent",flat:""},{default:v((()=>[b(p,{ref:"form","lazy-validation":"",id:"login-form",onSubmit:t[3]||(t[3]=x((t=>e.login()),["prevent"]))},{default:v((()=>[b(a,{class:"text-center pt-8 pb-6"},{default:v((()=>[b(s,{src:"logo.png","aspect-ratio":1.2})])),_:1}),b(u,null,{default:v((()=>[b(l,{modelValue:e.model.username,"onUpdate:modelValue":t[0]||(t[0]=t=>e.model.username=t),variant:"outlined",density:"comfortable",label:"Username",class:"px-2 pb-3 font-weight-medium custom-label text-white",rules:[e.rules],"prepend-inner-icon":"mdi-account",color:"white"},null,8,["modelValue","rules"]),b(l,{modelValue:e.model.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.model.password=t),variant:"outlined",density:"comfortable",label:"Password",class:"px-2 font-weight-medium custom-label text-white",rules:[e.rules],type:e.show?"text":"password","prepend-inner-icon":"mdi-key","append-inner-icon":e.show?"mdi-eye":"mdi-eye-off","onClick:appendInner":t[2]||(t[2]=t=>e.show=!e.show),color:"white"},null,8,["modelValue","rules","type","append-inner-icon"])])),_:1}),b(f,{class:"pa-2 mb-3 px-5 ma-0"},{default:v((()=>[b(d,{form:"login-form",type:"submit",class:"px-5",color:"btn-primary",variant:"flat",block:"",size:"large",loading:e.loading},{default:v((()=>[t[4]||(t[4]=B(" Login ")),b(c,{icon:"mdi-login"})])),_:1},8,["loading"])])),_:1})])),_:1},512)])),_:1},8,["width"])])),_:1}),b(T,null,{default:v((()=>[b(I,null,{default:v((()=>[_("span",M,"Version "+C(e.version),1)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-c2fbb6b0"]]))}}}));
